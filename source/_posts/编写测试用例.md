---
title: 编写测试用例
date: 2025-09-13 23:58:29
tags:
---

## 1 测试环境搭建
### 1.1 安装gtest
```
# 安装编译依赖
sudo apt update
sudo apt install -y build-essential cmake git

# 克隆 GTest 仓库
git clone https://github.com/google/googletest.git
cd googletest

# 创建构建目录
mkdir build
cd build

# 配置和编译
cmake ..
make -j$(nproc)

# 安装到系统
sudo make install

# 更新库缓存
sudo ldconfig
```
### 1.2 测试gtest
```
#include <gtest/gtest.h>

TEST(SimpleTest, BasicAssertion) {
    EXPECT_EQ(1 + 1, 2);
}

int main(int argc, char **argv) {
    testing::InitGoogleTest(&argc, argv);
    return RUN_ALL_TESTS();
}

```
```
g++ test_gtest.cpp -lgtest -lgtest_main -pthread -o test_gtest
./test_gtest
```
## 2 CMake 项目中使用 GTest
```
# 查找 GTest 包
find_package(GTest REQUIRED)

# 启用测试功能（必须在项目定义之后）
enable_testing()

# 添加测试可执行文件
add_executable(test_program test.cpp)

# 链接 GTest 库
target_link_libraries(test_program PRIVATE GTest::gtest GTest::gtest_main)

# 添加测试
add_test(NAME MyTest COMMAND test_program)
```
`ctest`